<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>B√†i t·∫≠p Tr·∫Øc nghi·ªám Ti·∫øng Anh - Shopping</title>
    <style>
        :root {
            --primary-blue: #e8f0fe;
            --dark-blue: #1a73e8;
            --border-color: #dadce0;
            --correct-green: #1e8e3e;
            --wrong-red: #d93025;
            --trans-color: #5f6368;
            --hint-bg: #fff8e1;
            --hint-text: #f57f17;
        }

        body {
            font-family: 'Segoe UI', Arial, sans-serif;
            background-color: #f8f9fa;
            margin: 0;
            display: flex;
            flex-direction: column;
            height: 100vh;
        }

        /* Header & Progress */
        .header {
            background: white;
            padding: 15px 30px;
            border-bottom: 1px solid var(--border-color);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .progress-container {
            width: 100%;
            height: 8px;
            background-color: #eee;
            border-radius: 4px;
            margin-top: 10px;
        }

        #progress-bar {
            width: 0%;
            height: 100%;
            background-color: var(--dark-blue);
            border-radius: 4px;
            transition: width 0.4s ease;
        }

        /* Layout */
        .main-container {
            display: flex;
            padding: 20px;
            gap: 25px;
            max-width: 1100px;
            margin: 0 auto;
            width: 100%;
            box-sizing: border-box;
            height: calc(100vh - 80px);
        }

        /* Sidebar */
        .sidebar {
            width: 280px;
            background: white;
            padding: 20px;
            border-radius: 12px;
            border: 1px solid var(--border-color);
            display: flex;
            flex-direction: column;
            height: fit-content;
            max-height: 95%;
            position: sticky;
            top: 0;
        }

        /* Stats Box trong Sidebar */
        .stats-box {
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 15px;
            border: 1px solid #eee;
        }
        
        .stat-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-size: 0.95em;
            color: #333;
        }
        
        .stat-value {
            font-weight: bold;
            color: var(--dark-blue);
        }

        /* Navigation Grid */
        .nav-container {
            flex: 1;
            overflow-y: auto;
            margin-bottom: 20px;
        }

        .question-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 8px;
        }

        .q-num {
            aspect-ratio: 1;
            border: 1px solid var(--border-color);
            border-radius: 5px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 0.85em;
            transition: 0.2s;
            background: #fff;
        }

        .q-num:hover { background-color: #f1f3f4; }
        .q-num.done { background-color: #eee; color: #555; }
        
        .q-num.done-correct {
            background-color: #e6f4ea; 
            border-color: var(--correct-green);
            color: var(--correct-green);
            font-weight: bold;
        }
        .q-num.done-wrong {
            background-color: #fce8e6;
            border-color: var(--wrong-red);
            color: var(--wrong-red);
            font-weight: bold;
        }

        /* N√∫t N·ªôp B√†i */
        .btn-submit {
            width: 100%;
            padding: 12px;
            background-color: var(--dark-blue);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            font-size: 1em;
            transition: 0.2s;
        }
        
        .btn-submit:hover {
            background-color: #1558b0;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }

        /* Quiz area */
        .quiz-area {
            flex: 1;
            overflow-y: auto;
            padding-right: 10px;
        }

        .question-card {
            background: white;
            padding: 25px;
            border-radius: 12px;
            border: 1px solid var(--border-color);
            margin-bottom: 25px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.05);
            display: flex;
            flex-direction: column;
        }

        .question-text {
            font-size: 1.1em;
            font-weight: 600;
            margin-bottom: 10px;
            line-height: 1.5;
            color: #202124;
        }

        /* N√∫t G·ª£i √Ω */
        .btn-hint-toggle {
            align-self: flex-start;
            background-color: white;
            border: 1px solid #ffb74d;
            color: #f57f17;
            padding: 5px 12px;
            border-radius: 15px;
            font-size: 0.85em;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 5px;
            margin-bottom: 10px;
            transition: 0.2s;
            font-weight: 500;
        }

        .btn-hint-toggle:hover { background-color: #fff8e1; }

        .hint-content {
            display: none;
            background-color: #fff3e0;
            border-left: 4px solid #ffb74d;
            padding: 10px 15px;
            margin-bottom: 15px;
            border-radius: 4px;
            font-size: 0.95em;
            color: #e65100;
        }
        
        .hint-content.show { display: block; animation: fadeIn 0.3s; }

        /* Styles cho ƒë√°p √°n */
        .options-list {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
        }

        .option-btn {
            padding: 12px 15px;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            background: white;
            text-align: left;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 1em;
            display: flex;
            flex-direction: column;
            position: relative;
        }

        .option-btn:hover:not(.disabled) {
            background-color: #f8f9fa;
            border-color: #bdc1c6;
        }

        .option-btn.disabled {
            cursor: default;
            opacity: 0.8;
        }

        .option-btn.correct {
            background-color: #e6f4ea;
            border-color: var(--correct-green);
            color: var(--correct-green);
        }

        .option-btn.wrong {
            background-color: #fce8e6;
            border-color: var(--wrong-red);
            color: var(--wrong-red);
        }

        /* N√∫t D·ªãch nghƒ©a */
        .btn-trans-toggle {
            margin-top: 20px;
            align-self: flex-start;
            background: #f1f3f4;
            border: none;
            padding: 8px 16px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.9em;
            color: #555;
            display: flex;
            align-items: center;
            gap: 6px;
            transition: 0.3s;
            font-weight: 500;
        }

        .btn-trans-toggle:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            background-color: #eee;
            color: #999;
        }
        
        .btn-trans-toggle:hover:not(:disabled) {
            background: #e8eaed;
            color: #1a73e8;
        }

        .trans-text {
            display: none;
            color: var(--trans-color);
            font-style: italic;
            font-size: 0.9em;
            margin-top: 6px;
            font-weight: normal;
            border-top: 1px dashed #eee;
            padding-top: 4px;
        }
        
        .trans-text.show { display: block; animation: fadeIn 0.3s; }

        .explanation-box {
            margin-top: 15px;
            padding: 12px;
            border-radius: 6px;
            background-color: #fffde7;
            border-left: 4px solid #fbc02d;
            display: none;
            font-size: 0.95em;
        }

        /* === Modal B·∫£ng T·ªïng K·∫øt === */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background: white;
            padding: 30px;
            border-radius: 15px;
            width: 400px;
            max-width: 90%;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            animation: zoomIn 0.3s;
        }

        .modal-score {
            font-size: 3em;
            font-weight: bold;
            color: var(--dark-blue);
            margin: 10px 0;
        }

        .modal-details {
            margin: 20px 0;
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
        }

        .modal-btn {
            padding: 10px 25px;
            background: var(--dark-blue);
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1.1em;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-5px); }
            to { opacity: 1; transform: translateY(0); }
        }
        @keyframes zoomIn {
            from { transform: scale(0.8); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }
    </style>
</head>
<body>

    <div class="header">
        <h2 style="margin:0; font-size: 1.2em; color: #202124;">L·ªõp 8 - Topic: Shopping</h2>
        <div class="progress-container">
            <div id="progress-bar"></div>
        </div>
    </div>

    <div class="main-container">
        <div class="sidebar">
            <h3 style="margin-top:0; color:#444">Th·ªëng k√™</h3>
            
            <div class="stats-box">
                <div class="stat-item">
                    <span>S·ªë c√¢u ƒë√∫ng:</span>
                    <span class="stat-value"><span id="stat-correct">0</span>/<span id="stat-total">37</span></span>
                </div>
                <div class="stat-item">
                    <span>ƒêi·ªÉm s·ªë:</span>
                    <span class="stat-value"><span id="stat-score">0.0</span>/10</span>
                </div>
            </div>

            <div class="nav-container">
                <h4 style="margin:0 0 10px 0;">Danh s√°ch c√¢u h·ªèi</h4>
                <div class="question-grid" id="q-nav"></div>
            </div>

            <button class="btn-submit" onclick="submitQuiz()">N·ªôp b√†i</button>
        </div>

        <div class="quiz-area" id="quiz-container"></div>
    </div>

    <div class="modal-overlay" id="result-modal">
        <div class="modal-content">
            <h2 style="color: #444; margin-top:0">B·∫£ng T·ªïng K·∫øt</h2>
            <div>ƒêi·ªÉm s·ªë c·ªßa b·∫°n:</div>
            <div class="modal-score" id="final-score">0.0</div>
            
            <div class="modal-details">
                <p>S·ªë c√¢u ƒë√∫ng: <b id="final-correct">0</b> / <span id="final-total">37</span></p>
                <p>X·∫øp lo·∫°i: <b id="final-rank" style="color: #e65100">---</b></p>
            </div>
            
            <button class="modal-btn" onclick="closeModal()">ƒê√≥ng & Xem l·∫°i</button>
        </div>
    </div>

    <script>
        const quizData = [
            // PART 1
            { q: "Online shopping is buying a product or service over the __________.", qVi: "Mua s·∫Øm tr·ª±c tuy·∫øn l√† mua s·∫£n ph·∫©m ho·∫∑c d·ªãch v·ª• qua __________.", key: ["Online shopping", "over the"], opts: ["supermarket", "internet", "shopping centre", "open-air market"], optsVi: ["si√™u th·ªã", "internet", "trung t√¢m mua s·∫Øm", "ch·ª£ tr·ªùi"], correct: 1, exp: "ƒê·ªãnh nghƒ©a c·ªßa Online Shopping l√† mua h√†ng qua <b>Internet</b>." },
            { q: "To shop online, you visit a seller‚Äôs website and __________ the product you want.", qVi: "ƒê·ªÉ mua s·∫Øm tr·ª±c tuy·∫øn, b·∫°n truy c·∫≠p trang web c·ªßa ng∆∞·ªùi b√°n v√† __________ s·∫£n ph·∫©m b·∫°n mu·ªën.", key: ["visit website", "product you want"], opts: ["bargain", "select", "display", "spend"], optsVi: ["m·∫∑c c·∫£", "l·ª±a ch·ªçn", "tr∆∞ng b√†y", "chi ti√™u"], correct: 1, exp: "H√†nh ƒë·ªông ch·ªçn h√†ng tr√™n website l√† <b>select</b>." },
            { q: "Online shopping is very __________ because you can buy things anytime and anywhere.", qVi: "Mua s·∫Øm tr·ª±c tuy·∫øn r·∫•t __________ v√¨ b·∫°n c√≥ th·ªÉ mua ƒë·ªì m·ªçi l√∫c, m·ªçi n∆°i.", key: ["anytime", "anywhere"], opts: ["offline", "rare", "convenient", "home-grown"], optsVi: ["ngo·∫°i tuy·∫øn", "hi·∫øm", "ti·ªán l·ª£i", "c√¢y nh√† l√° v∆∞·ªùn"], correct: 2, exp: "Mua ƒë∆∞·ª£c m·ªçi l√∫c m·ªçi n∆°i l√† ƒë·∫∑c ƒëi·ªÉm c·ªßa s·ª± ti·ªán l·ª£i (<b>convenient</b>)." },
            { q: "With __________, people can shop from home without travelling.", qVi: "V·ªõi __________, m·ªçi ng∆∞·ªùi c√≥ th·ªÉ mua s·∫Øm t·∫°i nh√† m√† kh√¥ng c·∫ßn ƒëi l·∫°i.", key: ["shop from home", "without travelling"], opts: ["browsing", "internet access", "fixed price", "price tag"], optsVi: ["duy·ªát web", "k·∫øt n·ªëi internet", "gi√° c·ªë ƒë·ªãnh", "nh√£n gi√°"], correct: 1, exp: "C·∫ßn c√≥ <b>internet access</b> ƒë·ªÉ mua s·∫Øm t·∫°i nh√†." },
            { q: "One disadvantage of online shopping is that products are __________ what you expect.", qVi: "M·ªôt b·∫•t l·ª£i c·ªßa mua s·∫Øm tr·ª±c tuy·∫øn l√† s·∫£n ph·∫©m __________ nh∆∞ b·∫°n mong ƒë·ª£i.", key: ["disadvantage", "what you expect"], opts: ["always", "usually", "sometimes", "never"], optsVi: ["lu√¥n lu√¥n", "th∆∞·ªùng xuy√™n", "ƒë√¥i khi kh√¥ng gi·ªëng", "kh√¥ng bao gi·ªù"], correct: 2, exp: "S·∫£n ph·∫©m th·ª±c t·∫ø <b>sometimes</b> (ƒë√¥i khi) kh√°c v·ªõi mong ƒë·ª£i." },
            { q: "If you are not happy with a product, you can return it, but you may have to __________.", qVi: "N·∫øu b·∫°n kh√¥ng h√†i l√≤ng v·ªõi s·∫£n ph·∫©m, b·∫°n c√≥ th·ªÉ tr·∫£ l·∫°i, nh∆∞ng b·∫°n c√≥ th·ªÉ ph·∫£i __________.", key: ["return it", "have to"], opts: ["bargain", "pay for shipping", "browse more", "lower the price"], optsVi: ["m·∫∑c c·∫£", "tr·∫£ ph√≠ v·∫≠n chuy·ªÉn", "xem th√™m", "h·∫° gi√°"], correct: 1, exp: "Khi ho√†n tr·∫£ h√†ng online, ng∆∞·ªùi mua th∆∞·ªùng ph·∫£i <b>pay for shipping</b> (tr·∫£ ti·ªÅn ship)." },
            { q: "Online shopping saves time and money because people don‚Äôt need to __________.", qVi: "Mua s·∫Øm tr·ª±c tuy·∫øn ti·∫øt ki·ªám th·ªùi gian v√† ti·ªÅn b·∫°c v√¨ m·ªçi ng∆∞·ªùi kh√¥ng c·∫ßn ph·∫£i __________.", key: ["saves time", "don‚Äôt need to"], opts: ["shop online", "spend time travelling", "browse products", "pay online"], optsVi: ["mua online", "t·ªën th·ªùi gian ƒëi l·∫°i", "xem h√†ng", "tr·∫£ ti·ªÅn online"], correct: 1, exp: "Ti·∫øt ki·ªám th·ªùi gian v√¨ kh√¥ng ph·∫£i <b>spend time travelling</b> (t·ªën th·ªùi gian ƒëi l·∫°i)." },
            { q: "Because there are many products to choose from, some people become a __________.", qVi: "V√¨ c√≥ qu√° nhi·ªÅu s·∫£n ph·∫©m ƒë·ªÉ l·ª±a ch·ªçn, m·ªôt s·ªë ng∆∞·ªùi tr·ªü th√†nh __________.", key: ["many products", "choose from"], opts: ["customer", "shopaholic", "seller", "manager"], optsVi: ["kh√°ch h√†ng", "ng∆∞·ªùi nghi·ªán mua s·∫Øm", "ng∆∞·ªùi b√°n", "qu·∫£n l√Ω"], correct: 1, exp: "S·ª± ƒëa d·∫°ng s·∫£n ph·∫©m d·ªÖ khi·∫øn ng∆∞·ªùi ta mua qu√° nhi·ªÅu v√† tr·ªü th√†nh <b>shopaholic</b>." },
            { q: "A shopaholic may buy things they don‚Äôt really __________.", qVi: "M·ªôt ng∆∞·ªùi nghi·ªán mua s·∫Øm c√≥ th·ªÉ mua nh·ªØng th·ª© h·ªç kh√¥ng th·ª±c s·ª± __________.", key: ["shopaholic", "don‚Äôt really"], opts: ["need", "display", "offer", "fix"], optsVi: ["c·∫ßn", "tr∆∞ng b√†y", "cung c·∫•p", "s·ª≠a ch·ªØa"], correct: 0, exp: "Ng∆∞·ªùi nghi·ªán mua s·∫Øm th∆∞·ªùng mua nh·ªØng th·ª© h·ªç kh√¥ng <b>need</b> (c·∫ßn)." },
            { q: "When shopping online, customers often __________ many products before deciding to buy.", qVi: "Khi mua s·∫Øm tr·ª±c tuy·∫øn, kh√°ch h√†ng th∆∞·ªùng __________ nhi·ªÅu s·∫£n ph·∫©m tr∆∞·ªõc khi quy·∫øt ƒë·ªãnh mua.", key: ["before deciding", "many products"], opts: ["display", "browse", "avoid", "return"], optsVi: ["tr∆∞ng b√†y", "xem l∆∞·ªõt/duy·ªát", "tr√°nh", "tr·∫£ l·∫°i"], correct: 1, exp: "H√†nh ƒë·ªông xem l∆∞·ªõt qua c√°c s·∫£n ph·∫©m tr√™n m·∫°ng g·ªçi l√† <b>browse</b>." },
            { q: "Products in online shops are usually shown with a __________.", qVi: "S·∫£n ph·∫©m trong c√°c c·ª≠a h√†ng tr·ª±c tuy·∫øn th∆∞·ªùng ƒë∆∞·ª£c hi·ªÉn th·ªã c√πng v·ªõi __________.", key: ["shown with", "online shops"], opts: ["costume", "price tag", "fixed place", "shelf"], optsVi: ["trang ph·ª•c", "nh√£n gi√°", "ƒë·ªãa ƒëi·ªÉm c·ªë ƒë·ªãnh", "k·ªá"], correct: 1, exp: "S·∫£n ph·∫©m th∆∞·ªùng ƒëi k√®m h√¨nh ·∫£nh v√† <b>price tag</b> (gi√° ti·ªÅn)." },
            { q: "Unlike offline shopping, online shopping does not allow customers to __________ products.", qVi: "Kh√¥ng gi·ªëng mua s·∫Øm tr·ª±c ti·∫øp, mua s·∫Øm tr·ª±c tuy·∫øn kh√¥ng cho ph√©p kh√°ch h√†ng __________ s·∫£n ph·∫©m.", key: ["Unlike offline", "does not allow"], opts: ["order", "touch", "pay for", "return"], optsVi: ["ƒë·∫∑t h√†ng", "ch·∫°m v√†o", "tr·∫£ ti·ªÅn", "tr·∫£ l·∫°i"], correct: 1, exp: "H·∫°n ch·∫ø c·ªßa online l√† kh√¥ng th·ªÉ <b>touch</b> (s·ªù/ch·∫°m) v√†o s·∫£n ph·∫©m." },
            { q: "People __________ shop online because it is easy and fast.", qVi: "M·ªçi ng∆∞·ªùi __________ mua s·∫Øm tr·ª±c tuy·∫øn v√¨ n√≥ d·ªÖ d√†ng v√† nhanh ch√≥ng.", key: ["easy and fast", "shop online"], opts: ["rarely", "never", "often", "hardly"], optsVi: ["hi·∫øm khi", "kh√¥ng bao gi·ªù", "th∆∞·ªùng xuy√™n", "h·∫ßu nh∆∞ kh√¥ng"], correct: 2, exp: "V√¨ ti·ªán l·ª£i n√™n m·ªçi ng∆∞·ªùi <b>often</b> (th∆∞·ªùng xuy√™n) mua s·∫Øm online." },
            { q: "When items are __________, customers can buy them at a lower price.", qVi: "Khi c√°c m√≥n h√†ng __________, kh√°ch h√†ng c√≥ th·ªÉ mua ch√∫ng v·ªõi gi√° th·∫•p h∆°n.", key: ["lower price", "items are"], opts: ["home-made", "on sale", "offline", "fixed"], optsVi: ["t·ª± l√†m", "ƒëang gi·∫£m gi√°", "ngo·∫°i tuy·∫øn", "c·ªë ƒë·ªãnh"], correct: 1, exp: "Gi√° th·∫•p h∆°n (lower price) nghƒ©a l√† h√†ng ƒëang <b>on sale</b> (gi·∫£m gi√°)." },
            { q: "Online shops usually offer a __________ of products for customers to choose from.", qVi: "C√°c c·ª≠a h√†ng tr·ª±c tuy·∫øn th∆∞·ªùng cung c·∫•p __________ s·∫£n ph·∫©m ƒë·ªÉ kh√°ch h√†ng l·ª±a ch·ªçn.", key: ["choose from", "products"], opts: ["lower price", "wide range", "minority group", "farmers‚Äô market"], optsVi: ["gi√° th·∫•p h∆°n", "s·ª± ƒëa d·∫°ng/ph·∫°m vi r·ªông", "nh√≥m thi·ªÉu s·ªë", "ch·ª£ n√¥ng s·∫£n"], correct: 1, exp: "C·ª•m t·ª´ <b>wide range of products</b> nghƒ©a l√† s·ª± ƒëa d·∫°ng s·∫£n ph·∫©m." },
            // PART 2
            { q: "Shopping centres usually __________ a lot of customers at weekends.", qVi: "C√°c trung t√¢m mua s·∫Øm th∆∞·ªùng __________ r·∫•t nhi·ªÅu kh√°ch h√†ng v√†o cu·ªëi tu·∫ßn.", key: ["Shopping centres", "customers"], opts: ["buy", "attract", "display", "spend"], optsVi: ["mua", "thu h√∫t", "tr∆∞ng b√†y", "chi ti√™u"], correct: 1, exp: "Trung t√¢m mua s·∫Øm <b>attract</b> (thu h√∫t) kh√°ch h√†ng." },
            { q: "Customers like shopping centres because they offer a __________ of products.", qVi: "Kh√°ch h√†ng th√≠ch trung t√¢m mua s·∫Øm v√¨ ch√∫ng cung c·∫•p __________ s·∫£n ph·∫©m.", key: ["offer a", "products"], opts: ["fixed price", "lower price", "wide range", "price tag"], optsVi: ["gi√° c·ªë ƒë·ªãnh", "gi√° th·∫•p", "s·ª± ƒëa d·∫°ng", "nh√£n gi√°"], correct: 2, exp: "T∆∞∆°ng t·ª± c√¢u tr√™n, <b>wide range</b> (s·ª± ƒëa d·∫°ng ch·ªßng lo·∫°i)." },
            { q: "People often feel more __________ when they can touch products before buying.", qVi: "M·ªçi ng∆∞·ªùi th∆∞·ªùng c·∫£m th·∫•y __________ h∆°n khi h·ªç c√≥ th·ªÉ ch·∫°m v√†o s·∫£n ph·∫©m tr∆∞·ªõc khi mua.", key: ["feel more", "touch products"], opts: ["convenient", "comfortable", "special", "excited"], optsVi: ["ti·ªán l·ª£i", "tho·∫£i m√°i/an t√¢m", "ƒë·∫∑c bi·ªát", "h√†o h·ª©ng"], correct: 1, exp: "ƒê∆∞·ª£c s·ªù t·∫≠n tay gi√∫p ng∆∞·ªùi mua c·∫£m th·∫•y <b>comfortable</b> (tho·∫£i m√°i/y√™n t√¢m) h∆°n." },
            { q: "Many shopping centres offer free __________ such as live music and performances.", qVi: "Nhi·ªÅu trung t√¢m mua s·∫Øm cung c·∫•p __________ mi·ªÖn ph√≠ nh∆∞ nh·∫°c s·ªëng v√† bi·ªÉu di·ªÖn.", key: ["music", "performances"], opts: ["exercise", "decorations", "entertainment", "internet access"], optsVi: ["t·∫≠p th·ªÉ d·ª•c", "trang tr√≠", "gi·∫£i tr√≠", "k·∫øt n·ªëi internet"], correct: 2, exp: "Nh·∫°c v√† bi·ªÉu di·ªÖn thu·ªôc v·ªÅ <b>entertainment</b> (gi·∫£i tr√≠)." },
            { q: "Some people go to shopping centres just to __________ with friends.", qVi: "M·ªôt s·ªë ng∆∞·ªùi ƒë·∫øn trung t√¢m mua s·∫Øm ch·ªâ ƒë·ªÉ __________ v·ªõi b·∫°n b√®.", key: ["with friends", "go to"], opts: ["bargain", "hang out", "spend money", "shop online"], optsVi: ["m·∫∑c c·∫£", "ƒëi ch∆°i/t·ª• t·∫≠p", "ti√™u ti·ªÅn", "mua online"], correct: 1, exp: "C·ª•m t·ª´ <b>hang out with friends</b> nghƒ©a l√† ƒëi ch∆°i/t·ª• t·∫≠p b·∫°n b√®." },
            { q: "During holidays, shopping centres are full of __________ and excitement.", qVi: "Trong c√°c ng√†y l·ªÖ, trung t√¢m mua s·∫Øm tr√†n ng·∫≠p __________ v√† s·ª± n√°o nhi·ªát.", key: ["holidays", "full of"], opts: ["costumes", "decorations", "shelves", "products"], optsVi: ["trang ph·ª•c", "ƒë·ªì trang tr√≠", "k·ªá h√†ng", "s·∫£n ph·∫©m"], correct: 1, exp: "Ng√†y l·ªÖ th√¨ th∆∞·ªùng c√≥ nhi·ªÅu <b>decorations</b> (ƒë·ªì trang tr√≠)." },
            { q: "People can walk in clean and well-lit areas to get some __________.", qVi: "M·ªçi ng∆∞·ªùi c√≥ th·ªÉ ƒëi b·ªô trong nh·ªØng khu v·ª±c s·∫°ch s·∫Ω v√† ƒë·ªß √°nh s√°ng ƒë·ªÉ __________.", key: ["walk", "get some"], opts: ["exercise", "sale", "browsing", "shopping"], optsVi: ["t·∫≠p th·ªÉ d·ª•c/v·∫≠n ƒë·ªông", "gi·∫£m gi√°", "xem h√†ng", "mua s·∫Øm"], correct: 0, exp: "ƒêi b·ªô (walk) l√† m·ªôt h√¨nh th·ª©c <b>exercise</b> (v·∫≠n ƒë·ªông)." },
            { q: "Shopping centres are very __________ because they have air conditioning and heating.", qVi: "Trung t√¢m mua s·∫Øm r·∫•t __________ v√¨ ch√∫ng c√≥ ƒëi·ªÅu h√≤a v√† m√°y s∆∞·ªüi.", key: ["air conditioning", "heating"], opts: ["rare", "offline", "convenient", "home-grown"], optsVi: ["hi·∫øm", "ngo·∫°i tuy·∫øn", "ti·ªán l·ª£i/tho·∫£i m√°i", "c√¢y nh√† l√° v∆∞·ªùn"], correct: 2, exp: "C√≥ ƒëi·ªÅu h√≤a nhi·ªát ƒë·ªô t·∫°o s·ª± <b>convenient</b> (ti·ªán nghi/ti·ªán l·ª£i) cho kh√°ch h√†ng." },
            { q: "When items are __________, they are sold at a lower price than usual.", qVi: "Khi c√°c m·∫∑t h√†ng __________, ch√∫ng ƒë∆∞·ª£c b√°n v·ªõi gi√° th·∫•p h∆°n b√¨nh th∆∞·ªùng.", key: ["lower price", "than usual"], opts: ["displayed", "fixed", "on sale", "home-made"], optsVi: ["ƒë∆∞·ª£c tr∆∞ng b√†y", "c·ªë ƒë·ªãnh", "ƒëang gi·∫£m gi√°", "t·ª± l√†m"], correct: 2, exp: "Gi√° th·∫•p h∆°n b√¨nh th∆∞·ªùng l√† <b>on sale</b>." },
            { q: "Some people visit shopping centres to avoid the heat or cold __________.", qVi: "M·ªôt s·ªë ng∆∞·ªùi ƒë·∫øn trung t√¢m mua s·∫Øm ƒë·ªÉ tr√°nh c√°i n√≥ng ho·∫∑c l·∫°nh ·ªü __________.", key: ["avoid heat/cold", "visit shopping centres"], opts: ["inside", "online", "outside", "usually"], optsVi: ["b√™n trong", "tr·ª±c tuy·∫øn", "b√™n ngo√†i", "th∆∞·ªùng xuy√™n"], correct: 2, exp: "V√†o trung t√¢m ƒë·ªÉ tr√°nh th·ªùi ti·∫øt kh·∫Øc nghi·ªát <b>outside</b> (b√™n ngo√†i)." },
            { q: "In supermarkets, products are usually __________ on shelves with price tags.", qVi: "Trong si√™u th·ªã, s·∫£n ph·∫©m th∆∞·ªùng ƒë∆∞·ª£c __________ tr√™n k·ªá v·ªõi nh√£n gi√°.", key: ["on shelves", "products"], opts: ["bargained", "displayed", "avoided", "spent"], optsVi: ["m·∫∑c c·∫£", "tr∆∞ng b√†y", "tr√°nh", "chi ti√™u"], correct: 1, exp: "H√†ng h√≥a ƒë·∫∑t tr√™n k·ªá nghƒ©a l√† ƒë∆∞·ª£c <b>displayed</b> (tr∆∞ng b√†y)." },
            { q: "Unlike farmers‚Äô markets, most shopping centres have __________ prices.", qVi: "Kh√¥ng gi·ªëng ch·ª£ n√¥ng s·∫£n, h·∫ßu h·∫øt c√°c trung t√¢m mua s·∫Øm c√≥ gi√° __________.", key: ["Unlike farmers‚Äô markets", "prices"], opts: ["lower", "fixed", "rare", "online"], optsVi: ["th·∫•p h∆°n", "c·ªë ƒë·ªãnh", "hi·∫øm", "tr·ª±c tuy·∫øn"], correct: 1, exp: "·ªû ch·ª£ th√¨ m·∫∑c c·∫£, c√≤n trung t√¢m th∆∞∆°ng m·∫°i th√¨ <b>fixed prices</b> (gi√° ni√™m y·∫øt/c·ªë ƒë·ªãnh)." },
            // PART 3
            { q: "Many people prefer online shopping because they can __________ at home.", qVi: "Nhi·ªÅu ng∆∞·ªùi th√≠ch mua s·∫Øm tr·ª±c tuy·∫øn v√¨ h·ªç c√≥ th·ªÉ __________ t·∫°i nh√†.", key: ["prefer online", "at home"], opts: ["bargain", "spend time", "shop", "display"], optsVi: ["m·∫∑c c·∫£", "d√†nh th·ªùi gian", "mua s·∫Øm", "tr∆∞ng b√†y"], correct: 2, exp: "H·ªç c√≥ th·ªÉ <b>shop</b> (mua s·∫Øm) ngay t·∫°i nh√†." },
            { q: "In an online shop, customers cannot __________ the products before buying.", qVi: "Trong c·ª≠a h√†ng tr·ª±c tuy·∫øn, kh√°ch h√†ng kh√¥ng th·ªÉ __________ s·∫£n ph·∫©m tr∆∞·ªõc khi mua.", key: ["cannot", "before buying"], opts: ["return", "touch", "order", "pay for"], optsVi: ["tr·∫£ l·∫°i", "ch·∫°m v√†o", "ƒë·∫∑t h√†ng", "tr·∫£ ti·ªÅn"], correct: 1, exp: "Kh√¥ng th·ªÉ <b>touch</b> (ch·∫°m) v√†o s·∫£n ph·∫©m online." },
            { q: "Shopping centres and supermarkets are examples of __________ shops.", qVi: "Trung t√¢m mua s·∫Øm v√† si√™u th·ªã l√† nh·ªØng v√≠ d·ª• v·ªÅ c·ª≠a h√†ng __________.", key: ["Shopping centres", "examples of"], opts: ["online", "offline", "discount", "speciality"], optsVi: ["tr·ª±c tuy·∫øn", "tr·ª±c ti·∫øp/truy·ªÅn th·ªëng", "gi·∫£m gi√°", "chuy√™n d·ª•ng"], correct: 1, exp: "ƒê√¢y l√† c√°c ƒë·ªãa ƒëi·ªÉm mua b√°n v·∫≠t l√Ω (<b>offline</b>)." },
            { q: "People often compare prices and read reviews when __________ online.", qVi: "M·ªçi ng∆∞·ªùi th∆∞·ªùng so s√°nh gi√° v√† ƒë·ªçc ƒë√°nh gi√° khi __________ tr·ª±c tuy·∫øn.", key: ["compare prices", "online"], opts: ["shopping", "spending", "displaying", "fixing"], optsVi: ["mua s·∫Øm", "chi ti√™u", "tr∆∞ng b√†y", "s·ª≠a ch·ªØa"], correct: 0, exp: "H√†nh ƒë·ªông n√†y di·ªÖn ra khi <b>shopping</b> online." },
            { q: "Some customers like discount shops because they sell products at a __________.", qVi: "M·ªôt s·ªë kh√°ch h√†ng th√≠ch c·ª≠a h√†ng gi·∫£m gi√° v√¨ h·ªç b√°n s·∫£n ph·∫©m v·ªõi __________.", key: ["discount shops", "sell at"], opts: ["fixed price", "wide range", "lower price", "price tag"], optsVi: ["gi√° c·ªë ƒë·ªãnh", "ph·∫°m vi r·ªông", "gi√° th·∫•p h∆°n", "nh√£n gi√°"], correct: 2, exp: "C·ª≠a h√†ng gi·∫£m gi√° (discount shops) th√¨ b√°n v·ªõi <b>lower price</b>." },
            { q: "When shopping online, people may __________ too much money without noticing.", qVi: "Khi mua s·∫Øm tr·ª±c tuy·∫øn, m·ªçi ng∆∞·ªùi c√≥ th·ªÉ __________ qu√° nhi·ªÅu ti·ªÅn m√† kh√¥ng ƒë·ªÉ √Ω.", key: ["too much money", "without noticing"], opts: ["spend", "save", "avoid", "return"], optsVi: ["ti√™u", "ti·∫øt ki·ªám", "tr√°nh", "tr·∫£ l·∫°i"], correct: 0, exp: "D·ªÖ b·ªã <b>spend</b> (ti√™u) qu√° nhi·ªÅu ti·ªÅn." },
            { q: "In supermarkets, products are usually __________ on shelves.", qVi: "Trong si√™u th·ªã, s·∫£n ph·∫©m th∆∞·ªùng ƒë∆∞·ª£c __________ tr√™n k·ªá.", key: ["supermarkets", "on shelves"], opts: ["bargained", "displayed", "avoided", "ordered"], optsVi: ["m·∫∑c c·∫£", "tr∆∞ng b√†y", "tr√°nh", "ƒë·∫∑t h√†ng"], correct: 1, exp: "S·∫£n ph·∫©m ƒë∆∞·ª£c <b>displayed</b> (tr∆∞ng b√†y) tr√™n k·ªá." },
            { q: "Online shopping is not always safe because customers __________ know the seller well.", qVi: "Mua s·∫Øm tr·ª±c tuy·∫øn kh√¥ng ph·∫£i l√∫c n√†o c≈©ng an to√†n v√¨ kh√°ch h√†ng __________ bi·∫øt r√µ ng∆∞·ªùi b√°n.", key: ["not always safe", "know seller"], opts: ["always", "usually", "sometimes", "rarely"], optsVi: ["lu√¥n lu√¥n", "th∆∞·ªùng xuy√™n", "ƒë√¥i khi", "hi·∫øm khi"], correct: 3, exp: "V√¨ mua qua m·∫°ng n√™n kh√°ch h√†ng <b>rarely</b> (hi·∫øm khi) bi·∫øt r√µ ng∆∞·ªùi b√°n." },
            { q: "People who buy things they don‚Äôt need and can‚Äôt stop shopping are called __________.", qVi: "Nh·ªØng ng∆∞·ªùi mua nh·ªØng th·ª© h·ªç kh√¥ng c·∫ßn v√† kh√¥ng th·ªÉ ng·ª´ng mua s·∫Øm ƒë∆∞·ª£c g·ªçi l√† __________.", key: ["can‚Äôt stop shopping", "called"], opts: ["customers", "shopaholics", "sellers", "shoppers"], optsVi: ["kh√°ch h√†ng", "ng∆∞·ªùi nghi·ªán mua s·∫Øm", "ng∆∞·ªùi b√°n", "ng∆∞·ªùi mua"], correct: 1, exp: "Kh√¥ng ng·ª´ng mua s·∫Øm l√† d·∫•u hi·ªáu c·ªßa <b>shopaholics</b>." },
            { q: "With internet access, people can shop __________, even late at night.", qVi: "V·ªõi k·∫øt n·ªëi internet, m·ªçi ng∆∞·ªùi c√≥ th·ªÉ mua s·∫Øm __________, ngay c·∫£ v√†o ƒë√™m mu·ªôn.", key: ["late at night", "can shop"], opts: ["rarely", "never", "anytime", "offline"], optsVi: ["hi·∫øm khi", "kh√¥ng bao gi·ªù", "b·∫•t c·ª© l√∫c n√†o", "ngo·∫°i tuy·∫øn"], correct: 2, exp: "Mua ƒë∆∞·ª£c c·∫£ ƒë√™m mu·ªôn nghƒ©a l√† mua ƒë∆∞·ª£c <b>anytime</b> (b·∫•t c·ª© l√∫c n√†o)." }
        ];

        let answeredSet = new Set();
        let correctCount = 0;
        const totalCount = quizData.length;

        function initQuiz() {
            const container = document.getElementById('quiz-container');
            const nav = document.getElementById('q-nav');
            document.getElementById('stat-total').innerText = totalCount;
            document.getElementById('final-total').innerText = totalCount;

            quizData.forEach((item, index) => {
                const card = document.createElement('div');
                card.className = 'question-card';
                card.id = `q-card-${index}`;
                
                card.innerHTML = `
                    <div class="question-text">
                        Question ${index + 1}. ${item.q}
                        <div class="trans-text" id="trans-q-${index}">${item.qVi}</div>
                    </div>

                    <button class="btn-hint-toggle" onclick="toggleHint(${index})">
                        üí° G·ª£i √Ω
                    </button>
                    <div class="hint-content" id="hint-box-${index}">
                        <strong>Keywords:</strong> ${item.key.join('; ')}
                    </div>

                    <div class="options-list">
                        ${item.opts.map((opt, i) => `
                            <button class="option-btn" onclick="checkAnswer(this, ${index}, ${i})">
                                <span><b>${String.fromCharCode(65 + i)}.</b> ${opt}</span>
                                <span class="trans-text" id="trans-opt-${index}-${i}">(${item.optsVi[i]})</span>
                            </button>
                        `).join('')}
                    </div>
                    
                    <div class="explanation-box" id="exp-${index}"></div>

                    <button class="btn-trans-toggle" id="btn-trans-${index}" onclick="toggleTrans(${index})" disabled title="H√£y ch·ªçn ƒë√°p √°n tr∆∞·ªõc ƒë·ªÉ xem d·ªãch nghƒ©a">
                        üîí D·ªãch nghƒ©a
                    </button>
                `;
                container.appendChild(card);

                // Sidebar nav item
                const qNum = document.createElement('div');
                qNum.className = 'q-num';
                qNum.id = `nav-${index}`;
                qNum.innerText = index + 1;
                qNum.onclick = () => {
                    card.scrollIntoView({ behavior: 'smooth', block: 'center' });
                };
                nav.appendChild(qNum);
            });
        }

        function toggleHint(index) {
            document.getElementById(`hint-box-${index}`).classList.toggle('show');
        }

        function toggleTrans(index) {
            const qTrans = document.getElementById(`trans-q-${index}`);
            const btn = document.getElementById(`btn-trans-${index}`);
            
            qTrans.classList.toggle('show');
            for (let i = 0; i < 4; i++) {
                const optTrans = document.getElementById(`trans-opt-${index}-${i}`);
                if(optTrans) optTrans.classList.toggle('show');
            }
            
            if (qTrans.classList.contains('show')) {
                btn.innerHTML = 'üåê ·∫®n d·ªãch nghƒ©a';
                btn.style.backgroundColor = '#e8f0fe';
                btn.style.color = '#1a73e8';
            } else {
                btn.innerHTML = 'üåê D·ªãch nghƒ©a';
                btn.style.backgroundColor = '#f1f3f4';
                btn.style.color = '#555';
            }
        }

        function updateStats() {
            // C·∫≠p nh·∫≠t s·ªë c√¢u ƒë√∫ng
            document.getElementById('stat-correct').innerText = correctCount;
            // C·∫≠p nh·∫≠t ƒëi·ªÉm (thang 10, l√†m tr√≤n 1 s·ªë th·∫≠p ph√¢n)
            const score = (correctCount / totalCount * 10).toFixed(1);
            document.getElementById('stat-score').innerText = score;
        }

        function checkAnswer(btn, qIndex, optIndex) {
            if (answeredSet.has(qIndex)) return;
            answeredSet.add(qIndex);

            const buttons = btn.parentElement.querySelectorAll('.option-btn');
            const correctIndex = quizData[qIndex].correct;
            const expBox = document.getElementById(`exp-${qIndex}`);
            const transBtn = document.getElementById(`btn-trans-${qIndex}`);
            const navNum = document.getElementById(`nav-${qIndex}`);

            // M·ªü kh√≥a d·ªãch nghƒ©a
            if (transBtn.hasAttribute('disabled')) {
                transBtn.removeAttribute('disabled');
                transBtn.innerHTML = 'üåê D·ªãch nghƒ©a';
                transBtn.title = "Xem b·∫£n d·ªãch ti·∫øng Vi·ªát";
            }

            // X·ª≠ l√Ω ƒë√∫ng sai
            if (optIndex === correctIndex) {
                btn.classList.add('correct');
                navNum.classList.add('done-correct');
                correctCount++;
            } else {
                btn.classList.add('wrong');
                navNum.classList.add('done-wrong');
                // Hi·ªán ƒë√°p √°n ƒë√∫ng
                buttons[correctIndex].classList.add('correct');
            }

            // C·∫≠p nh·∫≠t th·ªëng k√™
            updateStats();

            // Kh√≥a c√°c n√∫t
            buttons.forEach(b => b.classList.add('disabled'));

            // Progress bar
            const percent = (answeredSet.size / quizData.length) * 100;
            document.getElementById('progress-bar').style.width = percent + '%';

            // Hi·ªán gi·∫£i th√≠ch
            expBox.innerHTML = `<strong>Gi·∫£i th√≠ch:</strong> ${quizData[qIndex].exp}`;
            expBox.style.display = 'block';
        }

        function submitQuiz() {
            // Ki·ªÉm tra xem ƒë√£ l√†m h·∫øt ch∆∞a
            if (answeredSet.size < totalCount) {
                const confirmSubmit = confirm(`B·∫°n m·ªõi l√†m ${answeredSet.size}/${totalCount} c√¢u. B·∫°n c√≥ ch·∫Øc mu·ªën n·ªôp b√†i kh√¥ng?`);
                if (!confirmSubmit) return;
            }

            const score = (correctCount / totalCount * 10).toFixed(1);
            
            // X·∫øp lo·∫°i
            let rank = "";
            if(score >= 9) rank = "Xu·∫•t s·∫Øc (Excellent)";
            else if(score >= 8) rank = "Gi·ªèi (Good)";
            else if(score >= 6.5) rank = "Kh√° (Fair)";
            else if(score >= 5) rank = "Trung b√¨nh (Average)";
            else rank = "C·∫ßn c·ªë g·∫Øng th√™m (Poor)";

            // ƒêi·ªÅn d·ªØ li·ªáu v√†o Modal
            document.getElementById('final-score').innerText = score;
            document.getElementById('final-correct').innerText = correctCount;
            document.getElementById('final-rank').innerText = rank;

            // Hi·ªán Modal
            document.getElementById('result-modal').style.display = 'flex';
        }

        function closeModal() {
            document.getElementById('result-modal').style.display = 'none';
        }

        window.onload = initQuiz;
    </script>
</body>
</html>
